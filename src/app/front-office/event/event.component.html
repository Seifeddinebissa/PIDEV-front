<div class="container mt-4">
  <h2 class="mb-4">Upcoming Events</h2>

  <!-- Loading Spinner -->
  <div *ngIf="loading" class="text-center my-5">
    <div class="spinner-border text-primary" role="status">
      <span class="visually-hidden">Loading...</span>
    </div>
  </div>

  <!-- Error Message -->
  <div *ngIf="error" class="alert alert-danger" role="alert">
    {{ error }}
  </div>

  <!-- No Events Message -->
  <div *ngIf="!loading && !error && events.length === 0" class="alert alert-info" role="alert">
    No events available at the moment.
  </div>

  <!-- Events Grid -->
  <div *ngIf="!loading && !error && events.length > 0" class="row row-cols-1 row-cols-md-3 g-4">
    <div class="col" *ngFor="let event of events">
      <div class="card h-100 shadow-sm">
        <!-- Image upload input -->
        <div class="position-relative">
          <img [src]="getImageUrl(event.imageUrl)" 
               class="card-img-top" 
               [alt]="event.eventName"
               style="height: 200px; object-fit: cover;">
          
          <div class="image-upload-overlay">
            <input type="file" 
                   accept="image/*" 
                   class="file-input" 
                   (change)="uploadImage($event, event.idEvent)"
                   [id]="'imageUpload' + event.idEvent">
            <label [for]="'imageUpload' + event.idEvent" class="upload-label">
              <i class="fas fa-camera"></i>
            </label>
          </div>
        </div>
        
        <!-- Loading indicator for image upload -->
        <div *ngIf="loading" class="upload-progress">
          <div class="progress">
            <div class="progress-bar" 
                 role="progressbar" 
                 [style.width.%]="uploadProgress"
                 [attr.aria-valuenow]="uploadProgress" 
                 aria-valuemin="0" 
                 aria-valuemax="100">
              {{uploadProgress}}%
            </div>
          </div>
        </div>
        
        <div class="card-body">
          <h5 class="card-title">{{event.eventName}}</h5>
          <p class="card-text" *ngIf="event.description">{{event.description}}</p>
          <div class="d-flex align-items-center mb-2">
            <i class="fas fa-map-marker-alt text-primary me-2"></i>
            <span>{{event.location}}</span>
          </div>
          <div class="d-flex align-items-center mb-2">
            <i class="far fa-calendar-alt text-primary me-2"></i>
            <span>{{event.start_Date | date:'mediumDate'}}</span>
          </div>
          <div class="d-flex align-items-center mb-3">
            <i class="fas fa-users text-primary me-2"></i>
            <span>Capacity: {{event.capacity}}</span>
          </div>
        </div>
        <div class="card-footer bg-transparent border-top-0">
          <button class="btn btn-primary w-100" (click)="viewEventDetails(event.idEvent)">
            View Details
          </button>
        </div>
      </div>
    </div>
  </div>
</div>
